
ping-pong 测试
===================

# 1. 概要

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# 2. 分类

## 2.1. 按网络连接方式分

### 2.1.1. 本机回环 (localhost loopback)

服务器 `ip` 指定为 `localhost` 或 `127.0.0.1`，客户端也运行在本机，这是 `本地loopback`（`回环`）方式，数据不经过本机物理网卡。主要测试网络库的极限性能，除去库本身和操作系统的区别外，基本是在测 `CPU` 和内存（包括缓存）的综合性能，这一般也称为 `socket` 库的 `基准测试`。

### 2.1.2. 本地局域网 (local enthernet)

服务器 `ip` 使用的是本机的网卡 `IP`，客户端安装在本地局域网的其他机器上。此时，网络库不在是瓶颈，主要测试的是局域网的性能，受局域网（路由器或交换机等）的网络带宽，`MTU` 参数等因素限制。实际项目中，常有一些内部应用走的是内部局域网，所以此测试还是很有意义的。同样的，本地局域网的测试结果也可以做为广域网测试的比较和基准。由于网络设备的限制，一般局域网可分为 `万兆网`，`千兆网`，`百兆网` 等几个级别。

### 2.1.3. 广域网 (internet)

服务器端和客户端分别处于不用的局域网/广域网内，数据必须流经广域网，网络带宽受限于运营商提供的网络环境，设备间的物理距离加大，经过的路由和交换机增多，延迟变高，网络波动也增大，但更接近大多数应用的实际网络环境，更加具有参考价值。

### 2.1.4. 跨大洋的广域网 (crossed-ocean internet)

服务器端和客户端处于两个不同国家或地区的广域网内，很有可能通过海底光缆，跨越大洲。网络延迟进一步增加，网络波动更严重，丢包也更明显，设备间的物理距离跨越大洋或大洲，不确定性增大，带宽受限于网络运营商或线路的国际出口带宽。实际应用中比较遇到此种情况，仅对 `Proxy`，`VPN`，`CDN` 等类型的应用有参考价值。

## 2.2. 按 Server/Client 工作模式分

### 2.2.1. 服务器端

#### 2.2.1.1. 单线程/单进程模式

服务器端只启用一个线程/进程处理网络请求，单线程效率高，但总的吞吐量不如多线程模式（但如果你的物理核心数较少，孰优孰劣还不好说）。

#### 2.2.1.2. 多线程模式

服务器端使用单进程多线程的模式处理网络连接，此方式的单一线程效率较好（可能不如单线程模式，但比多进程方式要稍高一点点），吞吐量也比较高，但缺点是如果一个线程出现异常，则整个进程会随之崩溃。除非有把握能处理所有的异常，且没有明显的 `bug` 导致进程频繁崩溃，可能采取此种方式。

#### 2.2.1.3. 多进程模式

服务器端使用多进程单线程的方式处理网络连接，此方式线程效率折中，吞吐量较高。优点是即使某个进程因为一些异常或 `bug` 崩溃了，进程间不会受影响，重新再起一个新进程处理网络连接即可。大多数情况下仅适用于 `Linux` 环境，因为 `Windows` 对这种方式支持不是很好。

### 2.2.2. 客户端

#### 2.2.2.1. 单线程模式

在同一个线程/进程里，使用协程或者任务切换来模拟多用户。

#### 2.2.2.2. 多进程模式

客户端使用多进程的方式来模拟多用户。

